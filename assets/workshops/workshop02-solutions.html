<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CITS5501 lab 2 (week 3) – Data-driven tests and test design – solutions</title>
  <style>
html {
line-height: 1.5;
font-family: sans-serif;
font-size: 12pt;
color: black;
background-color: white;
}
body {
margin: 0 auto;
max-width: 50em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 1em;
}
h1 {
font-size: 1.8em;
}
}
@media print {
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
background-color: hsl(0, 0%, 98%);
padding: .2em .4em;
font-size: 85%;
margin: 0;
}
pre {
margin: 1em 0;
background-color: hsl(0, 0%, 98%);
padding: 1em;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}

:not(pre) > code {
padding: 2px 4px;
font-size: 90%;
word-break: normal !important;
white-space: nowrap;
color: hsl(344.8,69%,10%);
background-color: hsl(342.9,37%,96%);
border-radius: 4px;
}
.sourceCode {
background-color: hsl(0, 0%, 98%);
overflow: visible;
}
hr {
background-color: #1a1a1a;
border: none;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid black;
border-bottom: 1px solid black;
}
th {
border-top: 1px solid black;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
  <style>
div.solutions {
border: solid 2pt hsla(120, 100%, 35%, 1);
border-radius: 5pt;
background-color: hsla(120, 100%, 50%, 0.1);
padding: 1em;
}
.block-caption {
display: block;
font-family: sans-serif;
font-weight: bold;
margin-bottom: 1.5rem;
text-align: center;
}
details[open] summary *.only-open {
opacity: 0.1;
}
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title"><p>CITS5501 lab 2 (week 3) – Data-driven tests and
test design – solutions</p></h1>
</header>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#parameterized-tests" id="toc-parameterized-tests">1.
Parameterized tests</a></li>
<li><a href="#preconditions-and-postconditions" id="toc-preconditions-and-postconditions">2. Preconditions and
postconditions</a></li>
<li><a href="#testability" id="toc-testability">3. Testability</a></li>
</ul>
</nav>
<p></p>
<h2 id="parameterized-tests">1. Parameterized tests</h2>
<p>Normal test methods in JUnit don’t take any parameters at all – for
instance, the <code>testAdd</code> method from last week’s code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Test</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">testAdd</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>      Calculator c <span class="op">=</span> <span class="kw">new</span> <span class="fu">Calculator</span><span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> result <span class="op">=</span> c<span class="op">.</span><span class="fu">add</span><span class="op">();</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assertEquals</span><span class="op">(</span>result<span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="st">&quot;result should be 7&quot;</span><span class="op">);</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>
<p>But in last week’s lab, we briefly saw an example of a
<em>parameterized test</em> in JUnit – these <em>do</em> take
parameters. The parameterized test was <code>addZeroHasNoEffect</code>,
which checks, for a range of <code>int</code> values, that using the
<code>Calculator</code> to add 0 to the number gives back the original
<code>int</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">/**</span> Adding zero to a number should always</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">*</span> give us the same number back<span class="co">.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">*/</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">@ParameterizedTest</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">@ValueSource</span><span class="op">(</span> ints <span class="op">=</span> <span class="op">{</span> <span class="op">-</span><span class="dv">99</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">101</span><span class="op">,</span> <span class="dv">337</span>  <span class="op">})</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">void</span> <span class="fu">addZeroHasNoEffect</span><span class="op">(</span><span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      Calculator c <span class="op">=</span> <span class="kw">new</span> <span class="fu">Calculator</span><span class="op">(</span>num<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> result <span class="op">=</span> c<span class="op">.</span><span class="fu">add</span><span class="op">();</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assertEquals</span><span class="op">(</span>result<span class="op">,</span> num<span class="op">,</span> <span class="st">&quot;result should be same as num&quot;</span><span class="op">);</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>
<p>What do the <code>@ParameterizedTest</code> and
<code>@ValueSource</code> annotations on this test method mean?</p>
<p>Adding the <code>@ParameterizedTest</code> tells JUnit that this test
needs to be run in a special way. In effect, this annotation tells
JUnit: “You need to call this test multiple times. Each time you should
call it with a different <code>int</code>.” Where does Junit get the
<code>int</code>s from? We supplied a <code>@ValueSource</code>
annotation which tells JUnit “Here is the list of <code>int</code>s to
use with the test”. (But there are other ways of supplying the list of
<code>int</code>s besides writing them out explicitly as we’ve done here
– you could put them in <a href="https://junit.org/junit5/docs/5.7.1/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/CsvFileSource.html">a
<code>.csv</code> text file</a>, or write a special method that <a href="https://junit.org/junit5/docs/5.7.1/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/MethodSource.html">returns
a “stream” of ints</a>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>)</p>
<p>So to summarize: the test method, <code>addZeroHasNoEffect</code>,
takes <em>one</em> parameter, an <code>int</code>, and each time the
method is called, it is passed a different int from the list given by
<code>@ValueSource</code>.</p>
<p>The code for this week’s lab is the same as last week’s, but with
some new test methods, so you can try out the
<code>addZeroHasNoEffect</code> test if you haven’t already:</p>

<div style="border: solid 2pt blue; background-color: hsla(241, 100%,50%, 0.1); padding: 1em; border-radius: 5pt; margin-top: 1em;">
<p><strong>Exercises</strong></p>
<ol type="a">
<li>Run the tests in your IDE or editor to confirm that all those ints
are used – how can you tell?</li>
<li>Try changing them and/or adding to the list.</li>
<li><code>addZeroHasNoEffect</code> is a single method. But (based on
the material from lectures and the textbooks) is it also a single
<em>test case</em>? If not, how many test cases does it comprise?</li>
</ol>
</div>
<p></p>

<div class="solutions">
<p><strong>Sample solutions</strong>:</p>
<ol type="a">
<li>Most IDEs should show you exactly what tests cases have been run –
check the documentation for your IDE if it is not clear.</li>
<li>No solution needed here; the aim is just to practice working with
JUnit-based code.</li>
<li>Seven test cases, because there are seven <code>int</code>s in the
list.</li>
</ol>
</div>
<p></p>
<p>Hopefully the use of <code>@ValueSource</code> seems straightforward.
But a question may now arise: the
<code>addZeroHasNoEffect(int num)</code> test method takes only one
parameter, but what if we were working with a method that took two
parameters (a <code>String</code> and an <code>int</code>, say). Or what
if we wish to specify not just the <em>test</em> values, but also the
<em>expected</em> values (a very common situation)? How could we supply
multiple sets of parameters in that case?</p>
<p>Below is an example of such a method with multiple parameters. It’s
taken from this week’s code, which includes an additional test method
when compared with last week’s: <code>tableOfTests()</code>. The
<code>tableOfTests()</code> method is another parameterized test; it
draws its test values and expected values from a method called
<code>additionTestCasesProvider()</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  <span class="at">@ParameterizedTest</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">@MethodSource</span><span class="op">(</span><span class="st">&quot;additionTestCasesProvider&quot;</span><span class="op">)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">/**</span> Test Calculator<span class="co">.</span>add<span class="co">()</span> with multiple test values</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">*</span> and expected values<span class="co">.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>   <span class="co">*</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>   <span class="co">*</span> <span class="co">@</span>param num1 First test value to be passed to Calculator<span class="co">.</span>add<span class="co">()</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>   <span class="co">*</span> <span class="co">@</span>param num1 Second test value to be passed to Calculator<span class="co">.</span>add<span class="co">()</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">*</span> <span class="co">@</span>param expectedResult The expected result for Calculator<span class="co">.</span>add<span class="co">()</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>   <span class="co">*/</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">void</span> <span class="fu">tableOfTests</span><span class="op">(</span><span class="dt">int</span> num1<span class="op">,</span> <span class="dt">int</span> num2<span class="op">,</span> <span class="dt">int</span> expectedResult<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      Calculator c <span class="op">=</span> <span class="kw">new</span> <span class="fu">Calculator</span><span class="op">(</span>num1<span class="op">,</span> num2<span class="op">);</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> result <span class="op">=</span> c<span class="op">.</span><span class="fu">add</span><span class="op">();</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">assertEquals</span><span class="op">(</span>expectedResult<span class="op">,</span> result<span class="op">,</span> <span class="st">&quot;result should be same as as expected result&quot;</span><span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>
<p>In the previous example, we used the <code>@ValueSource</code>
annotation, which is used when you have a straightforward list of
literal values you want JUnit to iterate over. But in
<code>tableOfTests</code>, we’re using a new annotation,
<code>@MethodSource</code>. If we annotate our test method with
<code>@MethodSource(&quot;additionTestCasesProvider&quot;)</code>, <!--
`\texttt{@MethodSource("additionTestCasesProvider")}`{=latex}
--> we are saying to JUnit, “Go and call the
<code>additionTestCasesProvider</code> method in order to get a list of
test values and expected values”. You can read more about
<code>MethodSource</code>s in the JUnit documentation on <a href="https://junit.org/junit5/docs/snapshot/user-guide/index.html#writing-tests-parameterized-tests">writing
parameterized tests</a>.</p>
<p>This sort of testing is called <em>data-driven</em> testing – we have
basically the same test being run, but with different values each time;
so it makes sense to write the logic for the test just once (rather than
four times).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Let’s look at the <code>additionTestCasesProvider()</code> method
which supplies the parameters used by <code>tableOfTests()</code>. The
<code>additionTestCasesProvider()</code> method uses Java’s <a href="https://docs.oracle.com/en/java/javase/19/docs/api/java.base/java/util/stream/package-summary.html">Stream
API</a>, introduced in Java 8. For the moment, you don’t need to know
the details of how the Stream API works – just that it when used with
JUnit, it gives us a convenient way of constructing “lists of lists”. In
the code below, the <code>arguments()</code> method will take any number
of arguments we like (here, three <code>int</code>s, comprising two test
values and an expected value) and group them together into a list-like
object (<code>Arguments</code>); and the <code>Stream.of()</code> method
will take any number of <code>Arguments</code> objects we like, and
group <em>those</em> together in a list-like object (of type
<code>Stream&lt;Arguments&gt;</code>):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="dt">static</span> Stream<span class="op">&lt;</span>Arguments<span class="op">&gt;</span> <span class="fu">additionTestCasesProvider</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> Stream<span class="op">.</span><span class="fu">of</span><span class="op">(</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>          <span class="co">// the arguments are:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>          <span class="co">//    num1, num2, and expected result.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arguments</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">),</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arguments</span><span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">10</span><span class="op">),</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arguments</span><span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">11</span><span class="op">)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">arguments</span><span class="op">(</span><span class="dv">99</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">100</span><span class="op">)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>

<div style="border: solid 2pt blue; background-color: hsla(241, 100%,50%, 0.1); padding: 1em; border-radius: 5pt; margin-top: 1em;">
<p><strong>Exercises</strong></p>
<ol type="a">
<li><p>How many <em>test cases</em> would you say
<code>tableOfTests</code> and <code>additionTestCasesProvider</code>
comprise?</p></li>
<li><p>Read through the JUnit documentation on writing parameterized
tests. (You might find the <a href="https://www.baeldung.com/">baeldung.com</a> <a href="https://www.baeldung.com/parameterized-tests-junit-5">“Guide to
JUnit 5 Parameterized Tests”</a> by <a href="https://www.baeldung.com/author/ali-dehghani">Ali Dehghani</a>
helpful as well.) If you have time, try experimenting with the different
features it describes.</p></li>
<li><p>In Java, <code>enum</code> types are used to represent types that
can take on values from only a distinct set. By convention, the values
are given names in ALL CAPS with underscores to separate words (also
called <a href="https://en.wikipedia.org/wiki/Snake_case#:~:text=SCREAMING_SNAKE_CASE&amp;text=uses-,SCREAMING_SNAKE_CASE">“SCREAMING_SNAKE_CASE”</a>).</p>
<p>For instance,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">enum</span> Weekday <span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  MON<span class="op">,</span> TUE<span class="op">,</span> WED<span class="op">,</span> THU<span class="op">,</span> FRI<span class="op">,</span> SAT<span class="op">,</span> SUN</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">enum</span> <span class="bu">Color</span> <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  RED<span class="op">,</span> ORANGE<span class="op">,</span> YELLOW<span class="op">,</span> BLUE<span class="op">,</span> GREEN<span class="op">,</span> INDIGO<span class="op">,</span> VIOLET</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>(For more on Java enums, including how to create enums with
constructors and fields, see the Java documentation on <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html">enum
types</a>.)</p>
<p>Suppose we need to run a test which should be passed each
<code>Weekday</code> in turn. Which JUnit annotation should we use for
this?</p></li>
<li><p>If you have used testing frameworks in languages other than Java
– how do they compare with JUnit? Do they offer facilities for creating
data-driven tests? Are these more or less convenient than the way things
are done with JUnit?</p></li>
</ol>
</div>
<p></p>

<div class="solutions">
<p><strong>Sample solutions</strong>:</p>
<ol type="a">
<li>Together, they comprise four test cases: <code>tableOfTests</code>
will get invoked four times, each time with different test values and
expected result.</li>
<li>No solution needed; the aim is just to familiarize yourself with
JUnit’s parameterized tests.</li>
<li>The JUnit documentation explains how the <code>@EnumSource</code>
annotation can be used with enum types. By default, an
<code>@EnumSource</code> will iterate over all the possible values of an
enum type, calling the test method once with each value.</li>
<li>Writing data-driven tests tends to be more convenient (and less
verbose) in languages which either are not statically type-checked (for
instance, JavaScript, Python and Ruby and Lisp-family languages) or
which have rich type systems and type inference<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
(like Scala, Ocaml and Haskell).<br />
But as we have seen, it is certainly possible in Java, and the Streams
API allows for more concise code than in earlier versions of Java.</li>
</ol>
</div>
<p></p>

<div style="border: solid 2pt blue; background-color: hsla(241, 100%,50%, 0.1); padding: 1em; border-radius: 5pt; margin-top: 1em;">
<p><strong>Challenge exercise</strong></p>
<p>Based on this example, try writing your own parameterized tests for
other methods (for instance, subtraction).</p>
<p>(Challenge exercises aren’t compulsory, but may be interesting or
good practice if you’ve completed all other work in the lab.)</p>
</div>
<p></p>
<h2 id="preconditions-and-postconditions">2. Preconditions and
postconditions</h2>
<p>Work through following scenario and exercises. After you’ve done so,
it’s suggested you drop in to a timetabled lab sessions to discuss and
compare your answers with other students, and/or obtain feedback from
the lab facilitator.</p>
<p>Consider the following scenario:</p>

<div style="border: solid 2pt blue; background-color: hsla(241, 100%,50%, 0.1); padding: 1em; border-radius: 5pt; margin-top: 1em;">
<div style="text-align: center;">
<p><b>Enrolment database</b></p>
</div>
<p></p>
<p>A database has a table for students, a table for units being offered,
and a table for enrolments. When a <em>unit</em> is removed as an
offering, all <em>enrolments</em> relating to that unit must also be
removed. The code for doing a unit removal currently looks like
this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span> Remove a unit from the system</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> <span class="co">*/</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="fu">removeUnit</span><span class="op">(</span><span class="bu">String</span> unitCode<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  units<span class="op">.</span><span class="fu">removeRecord</span><span class="op">(</span>unitCode<span class="op">);</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<p></p>
<p>If possible, it’s recommended you discuss the following questions
with a partner or in a small group, and come up with an answer for each.
But if that is not feasible, spend several minutes thinking about the
questions yourself before sharing ideas with the class.</p>

<div style="border: solid 2pt blue; background-color: hsla(241, 100%,50%, 0.1); padding: 1em; border-radius: 5pt; margin-top: 1em;">
<p><strong>Exercises</strong></p>
<ol type="a">
<li>What <em>preconditions</em> do you think there should be for calling
removeUnit()?</li>
<li>What <em>postconditions</em> should hold after it is called?</li>
<li>Does the scenario give rise to any system <em>invariants</em>?</li>
<li>Can you identify any problems with the code? Describe what defects,
failures and erroneous states might exist as a consequence.</li>
</ol>
<!-- x** -->
<p>If you don’t recall what preconditions, postconditions, and
invariants are, you might wish to review the week 1 readings.</p>
</div>
<p></p>

<div class="solutions">
<p><strong>Sample solutions</strong>:</p>
<p><strong><em>a. Preconditions</em></strong></p>
<p>Preconditions for <code>removeUnit</code> to complete properly, and
bring about the postconditions, might include:</p>
<ul>
<li><code>unitCode</code> is not <code>null</code></li>
<li><code>unitCode</code> represents a valid, existing unit code</li>
<li>The receiver object for <code>removeUnit()</code> (i.e., the object
reference it is being called on) is not <code>null</code></li>
<li>A valid database and database connection exist</li>
</ul>
<p><em>However</em>, note that we would not necessarily mention all of
these in the Javadoc comment for <code>removeUnit()</code>:</p>
<ul>
<li>Although it may be a precondition that <code>unitCode</code> is not
<code>null</code>, it is true for nearly all Java methods that their
arguments must not be null; we are more likely to document the
<em>opposite</em> case, where a <code>null</code> value <em>is</em>
allowed.</li>
<li>It is likely that “A valid database and database connection exist”
are preconditions for many of the methods in the class we are
considering. So we probably would mention this in the Javadoc comment
for the class as a whole, to save repeating ourselves.<br />
(For example, take a look at the documentation for Java’s <a href="https://docs.oracle.com/javase/8/docs/api/java/util/TreeMap.html"><code>java.util.TreeMap</code></a>
class. It says “This implementation provides guaranteed log(n) time cost
for the <code>containsKey</code>, <code>get</code>, <code>put</code> and
<code>remove</code> operations”, rather than repeating that statement
four times.)</li>
<li>It is a property of the Java language that a method can only be
successfully be called when the receiver object is not
<code>null</code>, else a <code>NullPointerException</code> will be
thrown. So this need not be mentioned.</li>
</ul>
<p>Other preconditions we need not document:</p>
<ul>
<li><p>That <code>unitCode</code> is of type <code>String</code>. If
<code>unitCode</code> were not of type <code>String</code>, the source
code couldn’t possibly have compiled, and we couldn’t be running the
program.<br />
(Or: if, somehow, <code>unitCode</code> referred to a spot in memory
that did <em>not</em> contain a String object, this would be an
indication that the Java Runtime Environment had somehow become
corrupted.)<br />
It is a guarantee of the Java language that parameters always have the
correct types.</p>
<p>(In Python, the situation is different. We might require that
<code>unitCode</code> supports particular string operations, since at
runtime, the parameter passed need not be of type
<code>str</code>.)</p></li>
</ul>
<p><strong>Tip</strong>: If asked in assignments or the exam to specify
preconditions for a method, we will nearly always be using the Java
language. If you specify preconditions like “The parameter
<code>String s</code> must be a <code>String</code>” you generally (a)
will not get any marks for saying so, and (b) will make the markers
think you don’t understand how Java works.</p>
<p></p>
<p></p>
<p><strong>Alternative solutions:</strong></p>
<ul>
<li>If we adopt the solution above, then that means that if
<code>unitCode</code> does not refer to a valid, existing unit code,
either this method or one of the methods we call should throw an
exception. (We would document <em>that</em> in our Javadoc as well, so
callers know what exceptions can be thrown.)<br />
But an alternative design is to simply do nothing when the unit code
does not exist. In that case, we should <em>not</em> throw an
exception.</li>
</ul>
<p>If you are not clear on what preconditions are from the lecture
slides, you might want to read <a href="https://secure.csse.uwa.edu.au/CITS5501-protected/">chapter 3</a>
of <em>Object-Oriented Design and Patterns</em> (2nd edn) by Cay S.
Horstmann. (This can be found in the “Unit Readings” via the LMS.)</p>
<p></p>
<p></p>
<p><strong>Sample solutions, cont’d</strong>:</p>
<p><strong><em>b. Postconditions</em></strong></p>
<p>The postcondition here could be stated as:</p>
<ul>
<li>“The unit with code <code>unitCode</code> does not exist in the
database, and no records in the enrolment table exist that refer to
it.”</li>
</ul>
<p><strong><em>c. System invariants</em></strong></p>
<p>Recall that invariants are assertions that should hold true before
and after every method call of a class (or, if we are describing
invariants for a whole subsystem or system, for all methods of classes
in the subsystem or system).</p>
<p>From what we are told, we can infer that there is at least the
following invariant (presumably, for the whole system):</p>
<ul>
<li>If an entry in the enrolments table refers to a unit code, then a
corresponding entry in the units table must exist.</li>
</ul>
<p>There might be others as well.</p>
<p><strong><em>d. Problems with the code</em></strong></p>
<p>We are not told what <code>units.removeRecord()</code> does,
exactly.</p>
<p>However, if we make the following assumption:</p>
<ul>
<li><code>removeRecord()</code> removes an entry from the units table,
and does not alter any other tables</li>
</ul>
<p>then there <em>is</em> a problem with the code: it should have
updated the enrolments table, to remove any references to the deleted
unit.</p>
<p>So a <em>defect</em> in the code is that it does not call whatever
methods are necessary to delete records from the enrolments table. (This
is a static property of the code.)</p>
<p>The system enters an <em>erroneous state</em> immediately after the
<code>removeUnit</code> method call, because now one of the system
invariants is not satisfied – the system is inconsistent.</p>
<p>As for <em>failures</em>: recall that these are ways in which the
system observably departs from its specification. It is likely that no
failure will occur <em>directly</em> after the <code>removeUnit</code>
method call. But the next time someone queries the system to see what
units a student was enrolled in: they may be recorded as being enrolled
in a non-existent unit, which likely <em>is</em> a failure.</p>
<p>If you are not clear about the difference between <em>faults</em>,
<em>failures</em>, and <em>erroneous states</em>, you might want to read
<a href="https://secure.csse.uwa.edu.au/CITS5501-protected/content/">chapter
11</a> of Bruegge and Dutoit, <em>Object-Oriented Software Engineering
Using UML, Patterns, and Java</em> (3rd edn), particularly section 11.3,
“Testing Concepts”.</p>
<p></p>
<p></p>
<p><strong>Alternative solution:</strong></p>
<ul>
<li>On the other hand, if we make the assumption that
<code>removeRecord</code> <em>does</em> correctly remove all enrolment
records which mention the deleted unit, then there is no fault. (This is
called “cascading a deletion”, in database terminology.)<br />
But we have to make one assumption or the other, and say which one we
are making and why.</li>
</ul>
</div>
<p></p>
<h2 id="testability">3. Testability</h2>
<p>Consider the following, each of which is supposed to be a requirement
or specification. Do you think it would be straightforward to write
tests for them? If not, why not? After answering these questions, you
might like to drop in to a timetabled lab session to compare your
answers with other students. Although model solutions will be provided,
there is often no single definitive answers to software engineering
questions such as these – different students may come up with slightly
different answers.</p>
<ol type="a">
<li>The flight booking system should be easy for travel agents to
use.</li>
<li>The <code>int String.indexOf(char ch)</code> method should return a
-1 if <code>ch</code> does not appear in the receiver string, or the
index at which it appears, if it does.</li>
<li>Internet-aware Toast-O-Matic toasters should have a mean time
between failure of 6 months.</li>
</ol>

<div class="solutions">
<p><strong>Sample solutions</strong>:</p>
<p>System requirements:</p>
<p><strong><em>a. “Easiness of use” requirement</em></strong></p>
<p>This would be difficult to test.</p>
<ul>
<li><p>“Easy to use” is not a very <em>precise</em> requirement. It is
the opposite of precise – it is <em>vague</em> or <em>fuzzy</em>; it is
difficult to pinpoint exactly which systems satisfy it and which
don’t.</p>
<p>A better requirement might be something like:</p>
<blockquote>
<p>“Travel agents shall be able to use all the system functions after
successful completion of a training course designed by the software
provider. After this training, the average number of errors made by
experienced users shall not exceed two per hour of system use.”</p>
</blockquote>
<p>(This is adapted from <em>Pressman</em>.)</p></li>
<li><p>A test like this requires human users, and would often not be
done until the <em>acceptance testing</em> phase. Prior to that, the
software provider might try to come up with a quicker and cheaper test
to act as a <em>proxy</em> for the acceptance test – they might test it
on non-technical staff in their own organisation, for instance.</p>
<p>(The staff in their own organisation are acting as a sort of <em>test
double</em> or <em>mock</em>, here – we will see more about these later.
When we write unit tests, a “mock” is some sort of object that “stands
in for” a real object that for some reason is difficult or inappropriate
to use.)</p></li>
</ul>
<p>If you are not clear about what makes a good requirement, you might
want to review the chapter from the <em>Pressman</em> textbook on
“Understanding Requirements” (in the 9th edition) or “Requirements
Engineering” (in earlier editions).<br />
There is also a quick summary (taken from documentation for an IBM
requirements management product) available <a href="https://www.informit.com/articles/article.aspx?p=1152528&amp;seqNum=4">here</a>.</p>
</div>
<p></p>
<!-- vim: syntax=markdown tw=92 :
-->
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>You can find a list of all the possible annotations you
can use for supplying parameters to parameterized tests in the JUnit <a href>API documentation</a> – look down the bottom of the page for
class names ending in “<code>Source</code>”. The API documentation is
fairly terse, though – if you’d like to see examples of how the
different sources are used in practice, check out the <a href="https://www.baeldung.com/parameterized-tests-junit-5">“Guide to
JUnit 5 Parameterized Tests”</a> by <a href="https://www.baeldung.com/author/ali-dehghani">Ali Dehghani</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This is an example of the <a href="https://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself">“DRY”
principle</a> (“Don’t Repeat Yourself”) in action. Writing out the same
test method four times, but each time with different test values and
expected values, would just lead to unmaintainable code.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://en.wikipedia.org/wiki/Type_inference">Type inference</a>
is a feature of some programming languages which allows the programmer
to omit types where compiler can work out what they should be.<br />
The Java language has only a very limited form of type inference. It
allows you to omit type arguments to generic types, in some cases –
e.g. <code>Map&lt;String, List&lt;String&gt;&gt; myMap = new HashMap&lt;&gt;()</code>
doesn’t need type arguments after <code>new HashMap</code> – and (since
Java 10) allows you to omit local variable declarations, instead using
<code>var</code>. See the Oracle documentation on <a href="https://docs.oracle.com/javase/tutorial/java/generics/genTypeInference.html">generics
type inference</a> and on <a href="https://developer.oracle.com/learn/technical-articles/jdk-10-local-variable-type-inference">Java
10 local variable type inference</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
